# 实时市场数据：5列布局优化

## 优化概述
将实时市场数据区域从4列布局改为5列布局，进一步提升数据密度和显示效率。

## 新布局结构

### 5列 × 5行 = 25个单元格

| 行号 | 列1 | 列2 | 列3 | 列4 | 列5 |
|------|-----|-----|-----|-----|-----|
| **第1行** | 最新价 | 开盘 | 最高 | 最低 | 均价 |
| **第2行** | 涨跌 | 涨跌幅 | 昨结算 | 昨收盘 | 收盘价 |
| **第3行** | 成交量 | 成交额 | 持仓量 | 昨持仓 | 结算价 |
| **第4行** | 涨停价 | 跌停价 | 合约 | 最小变动 | 合约乘数 |
| **第5行** | 行情时间（跨5列居中显示） ||||

## 数据分组逻辑

### 第1行：当日价格信息
- **最新价**：当前成交价
- **开盘**：今日开盘价
- **最高**：今日最高价（红色标识）
- **最低**：今日最低价（绿色标识）
- **均价**：今日均价

### 第2行：涨跌与历史价格
- **涨跌**：涨跌金额（红涨绿跌）
- **涨跌幅**：涨跌百分比（红涨绿跌）
- **昨结算**：上一交易日结算价
- **昨收盘**：上一交易日收盘价
- **收盘价**：当日收盘价（盘中为空）

### 第3行：成交与持仓
- **成交量**：今日总成交量（手）
- **成交额**：今日总成交额（亿/万元）
- **持仓量**：当前持仓量（显示变化）
- **昨持仓**：上一交易日持仓量
- **结算价**：当日结算价（盘中为空）

### 第4行：风控与合约
- **涨停价**：涨停板价格
- **跌停价**：跌停板价格
- **合约**：合约名称（如：沪银主连）
- **最小变动**：价格最小变动单位
- **合约乘数**：合约规格（kg/手）

### 第5行：时间信息
- **行情时间**：精确到秒的行情更新时间（跨5列居中）

## 修改内容

### 1. CSS样式调整（style.css）

```css
.extended-data-row {
    display: grid;
    grid-template-columns: repeat(5, 1fr);  /* 从4列改为5列 */
    gap: 4px;  /* 从5px减到4px，更紧凑 */
}
```

### 2. JS渲染逻辑重组（script.js）

**优化点：**
- 重新分配21个字段到5列布局
- 将"涨停/跌停"拆分为独立的两个字段
- 行情时间使用 `grid-column: span 5` 跨5列显示
- 持仓量变化字体从10px减到9px
- 部分长文本字体从12px减到10px

## 空间优化效果

### 布局对比

| 项目 | 4列布局 | 5列布局 | 改善 |
|------|---------|---------|------|
| 每行字段数 | 4个 | 5个 | +25% |
| 单元格宽度 | 较宽 | 较窄 | 更紧凑 |
| 网格间距 | 5px | 4px | -1px |
| 总高度 | ~215px | ~200px | -15px |
| 数据密度 | 高 | 更高 | +7% |

### 信息完整性

✅ **所有21个扩展字段全部保留**
- 价格类：7个（最新、开盘、最高、最低、均价、收盘、昨收盘）
- 涨跌类：4个（涨跌、涨跌幅、昨结算、结算价）
- 成交类：2个（成交量、成交额）
- 持仓类：2个（持仓量、昨持仓）
- 风控类：2个（涨停价、跌停价）
- 合约类：3个（合约名称、最小变动、合约乘数）
- 时间类：1个（行情时间）

## 视觉优化

### 字体大小调整
- **标签**：9px（保持）
- **数值**：12px（保持）
- **长文本**：10px（合约名称、乘数、时间）
- **变化值**：9px（持仓量变化）

### 颜色标识
- 🔴 最高价：红色
- 🟢 最低价：绿色
- 🔴 涨：红色（价格上涨）
- 🟢 跌：绿色（价格下跌）
- 🔴 增仓：红色（持仓增加）
- 🟢 减仓：绿色（持仓减少）

## 响应式支持

5列布局在不同屏幕下的表现：

### 桌面（≥1600px）
- ✅ 5列完整显示
- ✅ 每列宽度约80px
- ✅ 数据清晰易读

### 笔记本（1400-1600px）
- ✅ 5列正常显示
- ⚠️ 每列稍窄，但仍可读

### 平板（768-1024px）
- ✅ 纵向排列，不受影响

### 手机（<768px）
- ✅ 纵向排列，不受影响

## 适配建议

### 如果列太窄
可以进一步缩小字体：
```css
.extended-value {
    font-size: 11px;  /* 从12px减到11px */
}

.extended-label {
    font-size: 8px;  /* 从9px减到8px */
}
```

### 如果需要更多空间
可以减少padding和gap：
```css
.extended-data-item {
    padding: 3px;  /* 从4px减到3px */
}

.extended-data-row {
    gap: 3px;  /* 从4px减到3px */
}
```

## 测试验证

刷新页面后检查：
1. ✅ 实时市场数据显示为5列
2. ✅ 所有21个字段正常显示
3. ✅ 行情时间跨5列居中显示
4. ✅ 涨停价和跌停价分开显示
5. ✅ 文字清晰可读
6. ✅ 套利追踪面板完整可见

## 实际显示效果

### 布局示例（420px宽）
```
┌────┬────┬────┬────┬────┐
│最新│开盘│最高│最低│均价│ 第1行：价格
├────┼────┼────┼────┼────┤
│涨跌│涨幅│昨结│昨收│收盘│ 第2行：涨跌
├────┼────┼────┼────┼────┤
│成量│成额│持仓│昨持│结算│ 第3行：成交
├────┼────┼────┼────┼────┤
│涨停│跌停│合约│变动│乘数│ 第4行：风控
├────┴────┴────┴────┴────┤
│    行情时间: 10:06:44    │ 第5行：时间
└─────────────────────────┘
```

每列宽度约：(420px - 16px padding - 16px gap) / 5 ≈ 78px

## 优势分析

### 1. 数据密度提升
- 从4列→5列：+25%横向空间利用
- 总高度节省：~15px
- 更适合信息量大的场景

### 2. 信息分组优化
- 价格类信息集中在前2行
- 成交持仓类在第3行
- 风控合约类在第4行
- 逻辑清晰，便于快速查看

### 3. 视觉平衡
- 涨停跌停分开，更直观
- 行情时间跨列居中，视觉焦点
- 每行5个单元格，对称美观

## 性能影响

- ✅ 无性能影响（纯布局调整）
- ✅ 渲染速度不变
- ✅ 数据更新频率不变

## 更新日志

**2025-11-06**
- ✅ 将实时市场数据从4列改为5列
- ✅ 重新分配21个字段到5列布局
- ✅ 拆分涨停/跌停为独立字段
- ✅ 行情时间跨5列居中显示
- ✅ 优化间距和字体大小
- ✅ 持仓量变化字体缩小到9px

---

## 相关文件

- `frontend/style.css` - CSS布局样式（第729-733行）
- `frontend/script.js` - HTML渲染逻辑（第976-1078行）

